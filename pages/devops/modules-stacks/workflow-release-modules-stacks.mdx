---
title: "Release workflow"
description: "Step-by-step workflow for release branches merging into main for modules and stacks"
---

This workflow covers the process for preparing production releases from the `develop` branch and merging them into `main` for modules and stacks.

## Overview

Release branches are used to prepare new production releases from the `develop` branch. They allow for final testing, bugfixes, and documentation updates before merging to production.

<Warning>
Changes merged to `main` are production-ready and will be deployed. Ensure all testing and validation is complete before merging.
</Warning>

## Release Branch Steps

<Steps>
<Step title="Create Release Branch">
Create a release branch following the naming convention:

- **Modules/Stacks format**: `release/<YYYYMMDD>-<short-desc>`
- **Examples**:
  - `release/20241215-add-encryption-support`
  - `release/20241220-fix-rbac-issue`

<Tip>
Use the current date in YYYYMMDD format and a short, descriptive name for the release. The version will be automatically determined by the terraform-module-releaser when merged to `main`.
</Tip>
</Step>

<Step title="Open Pull Request to Main">
Open a pull request targeting the `main` branch.

The release action will perform an automatic summary.

<Frame>
<img src="/images/module-stack-release-plan.png" alt="GitHub env0 plan for release PR" />
</Frame>

Env0 will automatically start a plan affected modules/stacks.

<Frame>
<img src="/images/module-stack-release-pr-plan.png" alt="GitHub env0 plan for release PR" />
</Frame>

</Step>

<Step title="Prepare Release">
On the release branch:

- Perform final testing
- Resolve any last-minute issues

<Info>
Release branches should only contain bugfixes and documentation updates. New features should not be added to release branches.

The version and changelog will be automatically determined and generated by the terraform-module-releaser from your commit messages when merged to `main`.
</Info>
</Step>

<Step title="Review and Validate">
Review the release:

- Verify Terraform plan results
- Confirm all changes are intended for production
- Verify the expected version increment based on commit types

</Step>

<Step title="Apply Infrastructure to Staging">
Use env0 to apply the modules/stacks into staging:

```bash
env0 apply --path <project glob pattern>
```

- Trigger the apply by adding a PR comment with the command above
- Monitor the apply process

<Frame>
<img src="/images/module-stack-release-apply.png" alt="env0 apply to staging subscription" />
</Frame>

</Step>

<Step title="Validate Stage Infrastructure">
Check if everything is deployed as expected in the staging environment:

- Verify all resources are created correctly
- Test functionality and ensure it works as intended
- Check for any deployment errors or warnings
- Validate that the infrastructure matches the expected state

<Frame>
  <img src="/images/module-stack-release-checks-pass.png" alt="Request Approval Screenshot" />
</Frame>

**If errors are found:**

- **Small bugfix**: Fix the issue directly in the release branch and commit the changes
- **Further work needed**: Cancel the release and continue development in the `develop` branch

<Warning>
Only small bugfixes should be fixed in release branches. If significant changes or further development is needed, cancel the release and address the issues in `develop` first.
</Warning>
</Step>

<Step title="Get Approval">

Request approval after all plan and stage deploy checks have passed.

Obtain required approvals:

- Code review approval
- Release manager approval (if applicable)
- Successful env0 apply to staging
- Any other required sign-offs

<Warning>
Releases require additional scrutiny. Ensure all stakeholders have reviewed and approved before merging.
</Warning>
</Step>

<Step title="Merge to Main">
After approval merge the release branch into `main`.

<Check>
The terraform-module-releaser automatically determines versions and generates changelogs from your commit messages. No manual version or changelog management is required.
</Check>
</Step>

<Step title="Clean Up">
After successful deployment:

1. Destroy the env0 release staging environment
2. Delete the release branch

</Step>
</Steps>

